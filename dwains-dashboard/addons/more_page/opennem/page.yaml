#dwains_theme

- type: custom:dwains-flexbox-card
  items_classes: "col-xs-12 col-md-6 col-lg-4 col-xl-4"
  cards:
    - type: custom:apexcharts-card
      graph_span: 7d
      span:
        end: day
      header:
        show: true
        title: "Current Price"
        show_states: true
        colorize_states: true
      apex_config:
        chart:
          {
            type: "area",
            toolbar: { show: true, tools: { reset: true } },
            zoom: { type: "x", enabled: true, autoScaleYaxis: true },
          }
        stroke: { show: true, width: 2.5, curve: smooth }
        legend: { show: false }
        dataLabels: { enabled: false }
        fill:
          {
            type: "gradient",
            gradient:
              {
                shadeIntensity: 1,
                inverseColors: false,
                opacityFrom: 0.45,
                opacityTo: 0.05,
                stops: [20, 100, 100, 100],
              },
          }
        xaxis:
          {
            type: "datetime",
            labels: { datetimeFormatter: { month: "ddd", day: "ddd" } },
          }

      series:
        - entity: sensor.opennem_nsw1_current_price
          type: area
          name: Temp
          extend_to_end: false
          curve: smooth
          group_by:
            func: avg
            duration: 30m
    - type: custom:apexcharts-card
      graph_span: 7d
      span:
        end: day
      header:
        show: true
        title: "Generation Type"
        show_states: true
        colorize_states: true
      apex_config:
        chart:
          {
            type: "area",
            toolbar: { show: true, tools: { reset: true } },
            zoom: { type: "x", enabled: true, autoScaleYaxis: true },
          }
        stroke: { show: true, width: 2.5, curve: smooth }
        legend: { show: false }
        dataLabels: { enabled: false }
        fill:
          {
            type: "gradient",
            gradient:
              {
                shadeIntensity: 1,
                inverseColors: false,
                opacityFrom: 0.45,
                opacityTo: 0.05,
                stops: [20, 100, 100, 100],
              },
          }
        xaxis:
          {
            type: "datetime",
            labels: { datetimeFormatter: { month: "ddd", day: "ddd" } },
          }

      series:
        - entity: sensor.opennem_nsw1_gen_from_fossil_fuels
          type: area
          name: Fossil Fuels
          extend_to_end: false
          curve: smooth
          group_by:
            func: avg
            duration: 30m
        - entity: sensor.opennem_nsw1_gen_from_renewables
          type: area
          name: Renewables
          extend_to_end: false
          curve: smooth
          group_by:
            func: avg
            duration: 30m

    - type: custom:apexcharts-card
      graph_span: 7d
      span:
        end: day
      header:
        show: true
        title: "Generation vs Demand"
        show_states: true
        colorize_states: true
      experimental:
        color_threshold: true
      y_axis_precision: 0
      apex_config:
        chart:
          {
            type: "area",
            toolbar: { show: true, tools: { reset: true } },
            zoom: { type: "x", enabled: true, autoScaleYaxis: true },
          }
        stroke: { show: true, width: 1, curve: smooth }
        legend: { show: false }
        dataLabels: { enabled: false }
        fill:
          {
            type: "gradient",
            gradient:
              {
                shadeIntensity: 1,
                inverseColors: false,
                opacityFrom: 0.45,
                opacityTo: 0.05,
                stops: [20, 100, 100, 100],
              },
          }
        xaxis:
          {
            type: "datetime",
            labels: { datetimeFormatter: { month: "ddd", day: "ddd" } },
          }

      series:
        - entity: sensor.opennem_nsw1_generationvsdemand
          type: area
          name: Demand
          extend_to_end: false
          curve: smooth
          color: black
          group_by:
            func: avg
            duration: 30m
          color_threshold:
            - value: -3000
              color: "#23A76A"
              opacity: 0.7
            - value: -500
              color: "#56BF8D"
              opacity: 0.7
            - value: 0
              color: "#FFE8AB"
              opacity: 0.7
            - value: 500
              color: "#FF8D95"
              opacity: 0.7
            - value: 1000
              color: "#FD305F"
              opacity: 0.7

- type: custom:dwains-flexbox-card
  items_classes: "col-xs-12 col-sm-6 col-sm-6 col-xl-6"
  cards:
    - type: entities
      title: Current State
      style: |
        ha-card {
          padding-bottom: 10px;
          background-color: var(--dwains-theme-primary)
        }
        .card-header {
          padding: 5px 16px;
          font-size: 18px;
          font-weight: 700 !important;
        }
        .card-content div {
            margin: 0 !important;
        }
        #states {
          padding-top: 0px !important;
          padding-bottom: 0px !important;
        }
        .secondary {
          color: darkgray !important;
          margin-left: 2px !important;
        }
      entities:
        - entity: sensor.opennem_nsw1_current_price
          name: Current Price
        - entity: sensor.opennem_nsw1_temperature
          name: Average Temperature
        - entity: sensor.opennem_nsw1_electricity_demand
          name: Current Demand
        - entity: sensor.opennem_nsw1_imported_power
          name: Import from other Regions
        - entity: sensor.opennem_nsw1_exported_power
          name: Export to other Regions
        - type: section
        - entity: sensor.opennem_nsw1_electricity_generation
          name: Current Generation
        - entity: sensor.opennem_nsw1_gen_from_fossil_fuels
          name: Electricity Gen from Fossil Fuels
        - entity: sensor.opennem_nsw1_gen_from_renewables
          name: Electricity Gen from Renewables
        - type: section
        - entity: sensor.opennem_nsw1_generationvsdemand
          name: Generation vs Demand (-ve Excess, +ve Deficit)
          icon: mdi:power-cycle

    - type: custom:config-template-card
      variables:
        - states['sensor.opennem_nsw1_electricity_generation'].state
      entities:
        - sensor.opennem_nsw1_electricity_generation
      card:
        type: custom:auto-entities
        card:
          type: entities
          title: Current Generation
          style: |
            ha-card {
              padding-bottom: 10px;
              background-color: var(--dwains-theme-primary)
            }
            .card-header {
              padding: 5px 16px;
              font-size: 18px;
              font-weight: 700 !important;
            }
            .card-content div {
                margin: 0 !important;
            }
            #states {
              padding-top: 0px !important;
              padding-bottom: 0px !important;
            }
            .secondary {
              color: darkgray !important;
              margin-left: 2px !important;
            }
        sort:
          method: state
          reverse: true
          numeric: true
        filter:
          include:
            - group: group.opennem
              options:
                type: custom:bar-card
                style: |
                  ha-icon {
                    color: var(--dwains-theme-accent) !important;
                  }
                  ha-icon	 {
                    margin-top: -7px;
                    padding-right: 5px;
                  }
                  bar-card-indicator	 {
                    margin-top: -12px;
                    padding-right: 5px;
                  }
                  bar-card-name	 {
                    margin-top: -4.5px;
                    padding-left: 5px;
                  }
                  bar-card-backgroundbar	 {
                    margin-top: -3.5px;
                    # border-radius: 2.5px;
                  }
                  bar-card-currentbar	 {
                    margin-top: -3.5px;
                    # border-radius: 2.5px;
                  }
                  bar-card-targetbar	 {
                    margin-top: -3.5px;
                    # border-radius: 2.5px;
                  }
                  bar-card-targetmarker	 {
                    margin-top: -3.5px;
                    # border-radius: 2.5px;
                  }
                  bar-card-value	 {
                    margin-top: -4.5px;
                    padding-left: 5px;
                  }
                positions:
                  title: inside
                  value: inside
                entity_row: true
                min: 0
                max: "${vars[0]}"
                color: rgb(26,204,147,0.33)

- type: custom:dwains-flexbox-card
  items_classes: "col-xs-12 col-md-12 col-lg-12 col-xl-12"
  cards:
    - type: custom:apexcharts-card
      graph_span: 7d
      header:
        show: true
        title: "Amber Spot Prices, Last Week"
        show_states: true
        colorize_states: true
      span:
        end: hour
      all_series_config:
        stroke_width: 2
        type: area
        extend_to_end: false
        curve: stepline
      y_axis_precision: 0
      apex_config:
        chart:
          height: 300
          zoom:
            type: x
            enabled: true
            autoScaleYaxis: true
          toolbar:
            show: true
            autoSelected: zoom
            tools:
              zoom: true
              zoomin: false
              zoomout: false
              pan: false
              reset: true
        stroke: { show: true }
        legend:
          show: false
        dataLabels: { enabled: false }
        xaxis:
          {
            type: "datetime",
            labels: { datetimeFormatter: { month: "ddd", day: "ddd" } },
          }
        fill:
          {
            type: "gradient",
            gradient:
              {
                shadeIntensity: 1,
                inverseColors: false,
                opacityFrom: 0.45,
                opacityTo: 0.05,
                stops: [20, 100, 100, 100],
              },
          }
      series:
        - entity: sensor.amber_currentprice_e1
          name: E1 (Grid)
          group_by:
            func: last
            duration: 30min
          show:
            extremas: true
        - entity: sensor.amber_currentprice_e2
          name: E2 (Controlled Load)
          group_by:
            func: last
            duration: 30min
          show:
            extremas: true
        - entity: sensor.amber_currentprice_b1
          name: B1 (Solar)
          group_by:
            func: last
            duration: 30min
          show:
            extremas: true

- type: custom:dwains-flexbox-card
  items_classes: "col-xs-12 col-sm-12 col-sm-12 col-xl-12"
  cards:
    - type: custom:apexcharts-card
      graph_span: 59h
      header:
        show: true
        title: "Amber Price Prediction (General Usage - E1)"
        show_states: true
        colorize_states: true
      span:
        start: hour
        offset: -1d
      now:
        show: true
        label: "now"
        color: orange
      all_series_config:
        stroke_width: 2
        type: area
        extend_to_end: false
        curve: stepline
      experimental:
        color_threshold: true
      color_list:
        - orange
        - grey
      y_axis_precision: 0
      apex_config:
        chart:
          height: 300
          zoom:
            type: x
            enabled: true
            autoScaleYaxis: true
          toolbar:
            show: true
            autoSelected: zoom
            tools:
              zoom: true
              zoomin: false
              zoomout: false
              pan: false
              reset: true
        stroke: { show: true }
        legend:
          show: false
        dataLabels: { enabled: false }
        xaxis:
          {
            type: "datetime",
            labels: { datetimeFormatter: { month: "ddd", day: "ddd" } },
          }
        fill:
          {
            type: "gradient",
            gradient:
              {
                shadeIntensity: 1,
                inverseColors: false,
                opacityFrom: 0.45,
                opacityTo: 0.05,
                stops: [20, 100, 100, 100],
              },
          }
      series:
        - entity: sensor.amber_general_usage_price
          name: Historic Price
          show:
            extremas: true
        - entity: sensor.amber_general_usage_price
          name: Predicted Price
          data_generator: |
            return entity.attributes.price_forcecast.map((entry) => {
              return [new Date(entry.pricing_period), entry.price];
            });
          show:
            extremas: true

    - type: custom:apexcharts-card
      graph_span: 59h
      header:
        show: true
        title: "Amber Price Prediction (Solar Feed-In)"
        show_states: true
        colorize_states: true
      span:
        start: hour
        offset: -1d
      now:
        show: true
        label: "now"
        color: orange
      all_series_config:
        stroke_width: 2
        type: area
        extend_to_end: false
        curve: stepline
      experimental:
        color_threshold: true
      color_list:
        - orange
        - grey
      y_axis_precision: 0
      apex_config:
        chart:
          height: 300
          zoom:
            type: x
            enabled: true
            autoScaleYaxis: true
          toolbar:
            show: true
            autoSelected: zoom
            tools:
              zoom: true
              zoomin: false
              zoomout: false
              pan: false
              reset: true
        stroke: { show: true }
        legend:
          show: false
        dataLabels: { enabled: false }
        xaxis:
          {
            type: "datetime",
            labels: { datetimeFormatter: { month: "ddd", day: "ddd" } },
          }
        fill:
          {
            type: "gradient",
            gradient:
              {
                shadeIntensity: 1,
                inverseColors: true,
                opacityFrom: 0.45,
                opacityTo: 0.05,
                stops: [20, 100, 100, 100],
              },
          }
      series:
        - entity: sensor.amber_solar_feed_in_tariff
          name: Historic Price
          show:
            extremas: true
        - entity: sensor.amber_solar_feed_in_tariff
          name: Predicted Price
          show:
            extremas: true
          data_generator: |
            return entity.attributes.price_forcecast.map((entry) => {
              return [new Date(entry.pricing_period), entry.price];
            });

- type: custom:dwains-flexbox-card
  items_classes: "col-xs-12 col-sm-6 col-sm-6 col-xl-6"
  cards:
    - type: entities
      title: Amber Electric
      style: |
        ha-card {
          padding-bottom: 10px;
          background-color: var(--dwains-theme-primary)
        }
        .card-header {
          padding: 5px 16px;
          font-size: 18px;
          font-weight: 700 !important;
        }
        .card-content div {
            margin: 0 !important;
        }
        #states {
          padding-top: 0px !important;
          padding-bottom: 0px !important;
        }
        .secondary {
          color: darkgray !important;
          margin-left: 2px !important;
        }
      entities:
        - entity: sensor.amber_currentprice_e1
        - entity: sensor.amber_currentprice_e2
        - entity: sensor.amber_currentprice_b1
