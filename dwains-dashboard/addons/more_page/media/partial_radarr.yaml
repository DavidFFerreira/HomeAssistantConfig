---
type: custom:stack-in-card
mode: vertical
cards:
  - type: entities
    title: Radarr
    style: |
      ha-card {
        padding-bottom: 10px;
        background-color: var(--dwains-theme-primary)
      }
      .card-header {
        padding: 5px 16px;
        font-size: 18px;
        font-weight: 700 !important;
      }
      .card-content div {
          margin: 0 !important;
      }
      #states {
        padding-top: 0px !important;
        padding-bottom: 0px !important;
      }
      .secondary {
        color: darkgray !important;
        margin-left: 2px !important;
      }
    entities:
      - entity: sensor.radarr_status
        name: Radarr Version
      - entity: sensor.radarr_movies
        name: Tracked Movies
      - entity: sensor.radarr_upcoming
        name: Upcoming Movies

  - type: markdown
    title: Upcoming Tracked Movies
    style: |
      ha-card {
        padding-bottom: 10px;
        background-color: var(--dwains-theme-primary)
      }
      .card-header {
        padding: 5px 16px;
        font-size: 18px;
        font-weight: 700 !important;
      }
      .card-content div {
          margin: 0 !important;
      }
      p {
        margin-top: 2px !important;
        margin-bottom: 2px !important;
      }
      ul {
        margin-top: 2px !important;
        margin-bottom: 2px !important;
      }
      code {
        font-size: 8pt;
        line-height: normal;
        white-space: pre-wrap;
        }
    content: |-
      {% set prev = namespace(airdate=false) %}
      {% for item in state_attr('sensor.radarr_upcoming_media', 'data') %}
      {% if item.airdate %}
      {% set airdate = as_timestamp(item.airdate) | timestamp_custom('%a %b %d') %}
      {% if airdate != prev.airdate %}
        <b><u>{{ airdate }}</b></u>
        {% set prev.airdate = airdate %}
      {% endif %}
        * {{item.title}}
      {% endif %}
      {% endfor %}
