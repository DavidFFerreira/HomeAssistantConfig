---
type: custom:stack-in-card
mode: horizontal
cards:
  - type: entities
    title: Plex
    style: |
      ha-card {
        padding-bottom: 10px;
        background-color: var(--dwains-theme-primary)
      }
      .card-header {
        padding: 5px 16px;
        font-size: 18px;
        font-weight: 700 !important;
      }
      .card-content div {
          margin: 0 !important;
      }
      #states {
        padding-top: 0px !important;
        padding-bottom: 0px !important;
      }
      .secondary {
        color: darkgray !important;
        margin-left: 2px !important;
      }
    entities:
      - entity: sensor.plex_the_cube_2_electric_boogaloo
        name: Current User Count
        icon: mdi:plex
      - entity: sensor.plex_topuser
        name: Top User
        icon: mdi:plex
      - entity: sensor.plex_topmovie
        name: Most Watched Movie
        icon: mdi:plex
      - entity: sensor.plex_toptvshow
        name: Most Watched TV Show
        icon: mdi:plex
      - type: section
      - entity: sensor.plexstats_moviecount
        name: Library Stats - No. Movies
        icon: mdi:plex
      - entity: sensor.plexstats_tvshowcount
        name: Library Stats - No. TV Shows
        icon: mdi:plex
      - entity: sensor.plexstats_tvseasoncount
        name: Library Stats - No. TV Seasons
        icon: mdi:plex
      - entity: sensor.plexstats_tvepisodecount
        name: Library Stats - No. TV Episodes
        icon: mdi:plex

  - type: markdown
    card_mod:
      style:
        ha-markdown:
          $:
            ha-markdown-element: |
              table { width: 100%; border-spacing: 0; padding: 8px; border-radius: var(--ha-card-border-radius);}
              th { background-color: var(--dwains-theme-header-background); color: var(--dwains-theme-header-text); padding: 4px;}
              th:first-child { border-top-left-radius: var(--ha-card-border-radius); }
              th:last-child { border-top-right-radius: var(--ha-card-border-radius); }
              td { padding: 4px; }
              td em { font-size: 10px; }
              tr:nth-child(even) { background-color: var(--table-row-background-color); }
    content: |
      |Date|Detail|
      |:---:|:---:|:---|
      {% for item in state_attr('sensor.plex_recently_added', 'data') %}{% if item.airdate | default('', true) %}{% set airdate = as_timestamp(item.airdate) | timestamp_custom('%a %b %d') %}|{{ airdate }}|{{item.title}}<br/>_({{item.number}}, {{item.episode}})_|
      {% endif %}{% endfor %}

  - type: markdown
    card_mod:
      style:
        ha-markdown:
          $:
            ha-markdown-element: |
              table { width: 100%; border-spacing: 0; padding: 8px; border-radius: var(--ha-card-border-radius);}
              th { background-color: var(--dwains-theme-header-background); color: var(--dwains-theme-header-text); padding: 4px;}
              th:first-child { border-top-left-radius: var(--ha-card-border-radius); }
              th:last-child { border-top-right-radius: var(--ha-card-border-radius); }
              td { padding: 4px; }
              td em { font-size: 10px; }
              tr:nth-child(even) { background-color: var(--table-row-background-color); }
    content: |
      |Date|Detail|
      |:---:|:---:|:---|
      {% for item in state_attr('sensor.plex_recently_added_movies', 'data') %}{% if item.airdate | default('', true) %}{% set airdate = as_timestamp(item.airdate) | timestamp_custom('%a %b %d') %}|{{ airdate }}|{{item.title}}|
      {% endif %}{% endfor %}
